import{j as e,a5 as s,az as D,aA as L,d,aB as P,at as _,aC as T,aD as b,ax as A,ay as M}from"./index-10c3c5bb.js";import{T as o,ax as x,cr as z,cs as N,ct as W,cu as F,cv as G,ch as $,ci as X,cj as Y,ck as H,cl as Q,cm as V,I as J,cn as K,co as U}from"./cartReactiveIcon-f925d69e.js";import{S as Z}from"./SearchBar-6e12918d.js";const C=({children:t})=>e.jsx(o,{fontWeight:"bolder",fontSize:"1.2em",children:t}),k=({title:t,content:i})=>e.jsxs(s,{sx:{padding:2,backgroundColor:"background.paper"},children:[e.jsx(C,{children:t}),e.jsx(o,{color:"InactiveCaption",children:i})]}),q=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function w(t){return typeof t=="string"&&q.test(t)}const ee={paid:"En camino",delivered:"Entregado",canceled:"Cancelado",pending:"En tienda"},te=["En tienda","En camino","Entregado"],re=["En tienda","Entregado"];function ae(){var f,h,g,j,y,S,v,E;const{id:t}=D(),i=L(),c=d.useRef(),[I,O]=d.useState(),a=d.useRef(),m=P(_.ORDERS);console.log("ðŸš€ ~ file: OrderStatus.tsx:43 ~ OrderStatus ~ refProducts:",a);const R=(f=a.current)==null?void 0:f.order_products.reduce((r,{quantity:n,product:{price:l,discount_price:u}})=>r+n*(u??l),0),B=({search:r})=>{if(c.current&&b(new Date).diff(c.current,"second")<=30)throw new Error("Espere un momento");if(!w(r))throw new Error("Identificador no valido");c.current=new Date,i(`./${r}`,{relative:"path"})},p=d.useCallback(async()=>{if(!w(String(t)))throw new Error("Identificador no valido");const{order_status:r,...n}=await m({id:t,filter:{status:!0}});console.log("ðŸš€ ~ file: OrderStatus.tsx:78 ~ loadOrderResume ~ order_status:",r),a.current={...n,id:t},O(ee[r.name]??"En tienda")},[m,t]);return d.useEffect(()=>{t&&p()},[t,p]),t?e.jsxs(x,{maxWidth:"32rem",margin:"auto",spacing:2,children:[e.jsx(z,{steps:(((h=a.current)==null?void 0:h.delivery_way.token)==T.DELIVERY?te:re).map(r=>({label:r,isActive:r===I})),sx:{marginY:"2rem"}}),e.jsxs(x,{spacing:2,marginX:"1rem !important",children:[e.jsx(k,{title:"Numero de pedido",content:(g=a.current)==null?void 0:g.id}),e.jsx(k,{title:"Fecha de entrega estimada",content:b((j=a.current)==null?void 0:j.created_at).add(4,"day").toDate().toLocaleDateString("es-ES",{month:"long",day:"numeric"})}),e.jsxs(x,{spacing:2,pb:2,sx:{backgroundColor:"background.paper"},children:[e.jsx(s,{p:2,children:e.jsx(C,{children:"Productos"})}),(y=a.current)==null?void 0:y.order_products.map(({product:{price:r,discount_price:n,name:l},quantity:u})=>e.jsxs(s,{p:2,sx:{backgroundColor:"background.default"},children:[e.jsxs(s,{display:"flex",gap:1,children:[e.jsx(o,{children:l}),e.jsxs(o,{px:3/4,sx:{display:"grid",placeItems:"center",backgroundColor:"primary.main",borderRadius:3},children:["x",u]})]}),e.jsxs(o,{fontSize:"1.3em",fontWeight:"bolder",display:"flex",justifyContent:"flex-end",children:["S/. ",((n!=0&&n!=null?n:r)*u).toFixed(2)]})]},l))]})]}),e.jsx(N,{deliveryPrice:(S=a.current)==null?void 0:S.delivery_price}),e.jsx(W,{property:"TOTAL",icon:e.jsx("img",{src:F,alt:"money"}),value:`S/. ${(E=R??0+(((v=a.current)==null?void 0:v.delivery_price)??0))==null?void 0:E.toFixed()}`,sx:{fontWeight:"bold !important",fontSize:"1.1rem !important"}})]}):e.jsxs(s,{alignItems:"center",display:"flex",flexDirection:"column",height:"calc(100vh - 13rem)",justifyContent:{xs:"center",sm:"space-between"},padding:"0 1rem",children:[e.jsxs(s,{sx:{width:{xs:"100%",sm:"25rem"},marginTop:{xs:0,sm:"3rem"},marginBottom:{xs:"7rem",sm:0}},children:[e.jsx(o,{sx:{marginBottom:"2rem"},variant:"h3",children:"Ingresa tu nÃºmero de pedido"}),e.jsx(Z,{direction:"column",onSubmit:B,placeHolder:"ABC123",buttonSearch:e.jsx(G,{type:"submit",label:"buscar",variant:"contained"})})]}),e.jsx(s,{justifyContent:"center",sx:{display:{xs:"none",sm:"flex"},width:"100%"}})]})}function ie(){const t=$(),i=c=>{U(t?null:c.currentTarget)};return e.jsx(X,{navBar:e.jsx(Y,{cartComponent:e.jsx(H,{reduceQuantity:Q}),navigatorLinks:e.jsx(V,{}),mainLogo:e.jsx(A,{to:"/",children:e.jsx(M,{sx:{width:{xs:"70%",md:"8rem"}}})}),menu:e.jsx(J,{onClick:i,size:"small",children:e.jsx(K,{})})}),children:e.jsx(ae,{})})}export{ie as default};
