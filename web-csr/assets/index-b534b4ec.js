import{j as e,a5 as n,az as O,aA as B,aB as D,aC as R,d as i,aD as P,at as N,aE as v,ax as A,ay as T}from"./index-9cbf7fc1.js";import{T as a,ax as p,cs as _,ct as G,cu as M,cv as z,cn as F,cw as W,ch as $,ci as X,cj as H,ck as Q,cl as Y,cm as J,I as K,co as U,cp as V}from"./cartReactiveIcon-add18e6f.js";const C=({children:t})=>e.jsx(a,{fontWeight:"bolder",fontSize:"1.2em",children:t}),E=({title:t,content:s})=>e.jsxs(n,{sx:{padding:2,backgroundColor:"background.paper"},children:[e.jsx(C,{children:t}),e.jsx(a,{color:"InactiveCaption",children:s})]}),Z=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function b(t){return typeof t=="string"&&Z.test(t)}const q={canceled:"En camino",delivered:"Entregado"},ee=["En tienda","En camino","Entregado"];function te(){var g,j,y,S;const{id:t}=O(),s=B(),u=D(R.LOCAL_CONFIG),{deliveryPrice:w}=u(),x=i.useRef(),[k,I]=i.useState(),o=i.useRef(),h=P(N.ORDERS),m=(g=o.current)==null?void 0:g.order_products.reduce((r,{quantity:c,product:{price:d,discount_price:l}})=>r+c*(l??d),0),L=({search:r})=>{if(x.current&&v(new Date).diff(x.current,"second")<=30)throw new Error("Espere un momento");if(!b(r))throw new Error("Identificador no valido");x.current=new Date,s(`./${r}`,{relative:"path"})},f=i.useCallback(async()=>{if(!b(String(t)))throw new Error("Identificador no valido");const{order_status:r,...c}=await h({id:t,filter:{status:!0}});o.current={...c,id:t},I(q[r.name]??"En tienda")},[h,t]);return i.useEffect(()=>{t&&f()},[t,f]),t?e.jsxs(p,{maxWidth:"32rem",margin:"auto",spacing:2,children:[e.jsx(_,{steps:ee.map(r=>({label:r,isActive:r===k})),sx:{marginY:"2rem"}}),e.jsxs(p,{spacing:2,marginX:"1rem !important",children:[e.jsx(E,{title:"Numero de pedido",content:(j=o.current)==null?void 0:j.id}),e.jsx(E,{title:"Fecha de entrega estimada",content:v((y=o.current)==null?void 0:y.created_at).add(4,"day").toDate().toLocaleDateString("es-ES",{month:"long",day:"numeric"})}),e.jsxs(p,{spacing:2,pb:2,sx:{backgroundColor:"background.paper"},children:[e.jsx(n,{p:2,children:e.jsx(C,{children:"Productos"})}),(S=o.current)==null?void 0:S.order_products.map(({product:{price:r,discount_price:c,name:d},quantity:l})=>e.jsxs(n,{p:2,sx:{backgroundColor:"background.default"},children:[e.jsxs(n,{display:"flex",gap:1,children:[e.jsx(a,{children:d}),e.jsxs(a,{px:3/4,sx:{display:"grid",placeItems:"center",backgroundColor:"primary.main",borderRadius:3},children:["x",l]})]}),e.jsxs(a,{fontSize:"1.3em",fontWeight:"bolder",display:"flex",justifyContent:"flex-end",children:["S/. ",((c??r)*l+Number(w)).toFixed(2)]})]},d))]})]}),e.jsx(G,{}),e.jsx(M,{property:"TOTAL",icon:e.jsx("img",{src:z,alt:"money"}),value:`S/. ${m==null?void 0:m.toFixed()}`,sx:{fontWeight:"bold !important",fontSize:"1.1rem !important"}})]}):e.jsxs(n,{alignItems:"center",display:"flex",flexDirection:"column",height:"calc(100vh - 13rem)",justifyContent:{xs:"center",sm:"space-between"},padding:"0 1rem",children:[e.jsxs(n,{sx:{width:{xs:"100%",sm:"25rem"},marginTop:{xs:0,sm:"3rem"},marginBottom:{xs:"7rem",sm:0}},children:[e.jsx(a,{sx:{marginBottom:"2rem"},variant:"h3",children:"Ingresa tu nÃºmero de pedido"}),e.jsx(F,{direction:"column",onSubmit:L,placeHolder:"ABC123",buttonSearch:e.jsx(W,{type:"submit",label:"buscar",variant:"contained"})})]}),e.jsx(n,{justifyContent:"center",sx:{display:{xs:"none",sm:"flex"},width:"100%"}})]})}function ae(){const t=$(),s=u=>{V(t?null:u.currentTarget)};return e.jsx(X,{navBar:e.jsx(H,{cartComponent:e.jsx(Q,{reduceQuantity:Y}),navigatorLinks:e.jsx(J,{}),mainLogo:e.jsx(A,{to:"/",children:e.jsx(T,{sx:{width:{xs:"70%",md:"8rem"}}})}),menu:e.jsx(K,{onClick:s,size:"small",children:e.jsx(U,{})})}),children:e.jsx(te,{})})}export{ae as default};
